(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/order_sure"],{1569:function(t,e,o){"use strict";o.r(e);var r=o("5bbb"),n=o("bc83");for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);o("47b6");var i,a=o("f0c5"),d=Object(a["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],i);e["default"]=d.exports},"326f":function(t,e,o){},"47b6":function(t,e,o){"use strict";var r=o("326f"),n=o.n(r);n.a},"5bbb":function(t,e,o){"use strict";var r,n=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.addressList,function(e,o){var r=JSON.stringify(e);return{$orig:t.__get_orig(e),g0:r}}));t.$mp.data=Object.assign({},{$root:{l0:o}})},s=[];o.d(e,"b",function(){return n}),o.d(e,"c",function(){return s}),o.d(e,"a",function(){return r})},"629c":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=0,r="",n={data:function(){return{imgHttp:"",show_address:!1,detailsObj:"",totalprice:0,goodsArr:[],addressList:[],defaultAddress:"",totalpostage:0,endPrice:0,remake:"",source:"",discount:"",discountPrice:0,couponPrice:0}},methods:{to_member:function(){t.navigateTo({url:"./discount?type=1&&minPrice="+this.totalprice+"&&couponId="+JSON.stringify(r)})},createOrder:function(){if(null!=this.defaultAddress){var e=this,o={token:t.getStorageSync("token"),userid:t.getStorageSync("customer").userid,items:JSON.stringify(e.detailsObj),couponid:""==r?"":r.join(","),addressid:e.defaultAddress.id,remark:e.remake};console.log(o),this.ask("/app/order/createOrder","POST",o,function(o){console.log(o),""==o.data.orderid&&void 0==o.data.orderid||t.login({success:function(r){console.log(n);var n={token:t.getStorageSync("token"),orderid:o.data.orderid,userid:t.getStorageSync("customer").userid,code:r.code};e.ask("/app/order/payOrder","POST",n,function(e){console.log(e),e.data.data?t.requestPayment({provider:"wxpay",timeStamp:e.data.data.timeStamp+"",nonceStr:e.data.data.nonceStr,package:e.data.data.package,signType:"MD5",paySign:e.data.data.sign,success:function(e){console.log("success",e),t.navigateTo({url:"./order_details?id="+n.orderid+"&&source=goodsDetails"})},fail:function(e){console.log("dfail",e),"requestPayment:fail:[payment微信:-1]General errors"==e.errMsg?t.showToast({title:"支付失败!",icon:"none"}):t.showToast({title:"用户取消支付!",icon:"none"})}}):t.navigateTo({url:"./order_details?id="+n.orderid+"&&source=goodsDetails"})})},fail:function(){e.hint("登录失败")}})})}else this.hint("请选择地址")},chooseAddress:function(t){this.defaultAddress=JSON.parse(t.detail.value)},to_address:function(e){t.navigateTo({url:"./address?type="+e})},to_editAddress:function(e,o){t.navigateTo({url:"./address?type="+e+"&&data="+JSON.stringify(o)})},showAddress:function(){this.show_address=!this.show_address},getAddress:function(){var e=this,o={token:t.getStorageSync("token"),userid:t.getStorageSync("customer").userid};this.ask("/app/address/getAddressList","POST",o,function(t){e.addressList=t.data.addresslist})},getGoodsInfo:function(){var e=this,r={token:t.getStorageSync("token"),orderitem:JSON.stringify(e.detailsObj),userid:t.getStorageSync("customer").userid};this.ask("/app/order/getOrderInfo","POST",r,function(t){console.log(t),e.goodsArr=t.data.orderInfo.iteminfolist,e.totalprice=t.data.orderInfo.totalprice,e.totalpostage=t.data.orderInfo.totalpostage,e.discountPrice=Math.floor(Number(e.totalprice)*(1-e.discount/10)*100)/100,e.endPrice=Number(e.totalprice)-e.discountPrice-e.totalpostage,e.endPrice=Math.floor(100*e.endPrice)/100,e.endPrice=e.endPrice-o,e.endPrice<0&&(e.endPrice=0),e.defaultAddress=t.data.orderInfo.address})}},onLoad:function(e){this.discount=Number(t.getStorageSync("customer").discount),0==this.discount&&(this.discount=10),this.imgHttp=this.comHttp,this.detailsObj=JSON.parse(e.goodsObj);var n=this;t.$on("discountArr",function(t){n.couponPrice=t.discountPrice,o=n.couponPrice,r=t.choosed})},onShow:function(){this.getGoodsInfo(),this.getAddress()},onUnload:function(){o=0,r=""}};e.default=n}).call(this,o("543d")["default"])},"7b11":function(t,e,o){"use strict";(function(t){o("f0cb"),o("921b");r(o("66fd"));var e=r(o("1569"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},bc83:function(t,e,o){"use strict";o.r(e);var r=o("629c"),n=o.n(r);for(var s in r)"default"!==s&&function(t){o.d(e,t,function(){return r[t]})}(s);e["default"]=n.a}},[["7b11","common/runtime","common/vendor"]]]);